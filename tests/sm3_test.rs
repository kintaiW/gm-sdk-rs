use gm_sdk::sm3_hash; use gm_sdk::hmac_sm3; #[test] fn test_sm3_empty() {
    let data = [];
    let hash = sm3_hash(&data);
    let expected = [
        0x1A, 0xB2, 0x1D, 0x83, 0x55, 0xCF, 0xA1, 0x7F,
        0x8E, 0x61, 0x19, 0x48, 0x31, 0xE8, 0x1A, 0x8F,
        0x22, 0xBE, 0xC8, 0xC7, 0x28, 0xFE, 0xFB, 0x74,
        0x7E, 0xD0, 0x35, 0xEB, 0x50, 0x82, 0xAA, 0x2B
    ];
    assert_eq!(hash, expected);
}

#[test]
fn test_sm3_hello() {
    let data = b"hello";
    let hash = sm3_hash(data);
    let expected = [
        0xBE, 0xCB, 0xBF, 0xAA, 0xE6, 0x54, 0x8B, 0x8B,
        0xF0, 0xCF, 0xCA, 0xD5, 0xA2, 0x71, 0x83, 0xCD,
        0x1B, 0xE6, 0x09, 0x3B, 0x1C, 0xCE, 0xCC, 0xC3,
        0x03, 0xD9, 0xC6, 0x1D, 0x0A, 0x64, 0x52, 0x68
    ];
    assert_eq!(hash, expected);
}

#[test]
fn test_hmac_sm3() {
    let key = b"key";
    let data = b"hello";
    let hmac = hmac_sm3(key, data);
    // 这里使用一个示例值，实际应该使用正确的HMAC-SM3结果
    // 注意：此测试需要根据实际实现调整预期值
    assert_eq!(hmac.len(), 32);
}

#[test]
fn test_hmac_sm3_long_key() {
    let key = b"this is a very long key that exceeds 64 bytes in length";
    let data = b"hello";
    let hmac = hmac_sm3(key, data);
    assert_eq!(hmac.len(), 32);
}